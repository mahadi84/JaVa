
Ask it gmini:

java code with database connection and steps to redirect after login check in servlet in eclipse 2024 in maven project with session and init(), destroy()?


-------------Steps:-----------------

1. Create a Dynamic Web Project in Eclipse and convert it to maven project.
2. Add the mysql-connector-java and servlet api dependency in pom.xml file.
3. Create a database and user table with username and password columns.
4. Create login.html page.
5. Create LoginServlet.java file.
6. Implement init(), doPost(), and destroy() methods.
7. In init(), establish a database connection.
8. In doPost(), retrieve username and password from the request.
9. Query the database to check if the credentials are valid.
10. If valid, create a session and set the username attribute, then redirect to welcome.jsp.
11. If invalid, display an error message and include the login.html page.
12. In destroy(), close the database connection.
13. Create welcome.jsp to display a welcome message and a logout link.
14. Create LogoutServlet.java file.
15. In LogoutServlet, invalidate the session and redirect to login.html.
16. Replace placeholders in the code (database URL, username, password, table name).
17. deploy and run the project.

Important Notes:
   * Replace placeholders like "your_database", "your_username", "your_password" with your actual database credentials.
   * Handle exceptions appropriately in a production environment.
   * Consider using a connection pool for better performance.
   * Hash passwords before storing them in the database.
   * Use HTTPS for secure communication.
   * Properly handle session management to prevent security vulnerabilities.
   * Make sure you have a mysql database running.
   * Add error pages for better user experience.
   * For eclipse 2024, ensure you have the correct java and web development plugins installed.




------------------ CODE ------------------------------
// pom.xml (Maven dependencies)
<dependencies>	
    <dependency>
      <groupId>jakarta.servlet</groupId>
      <artifactId>jakarta.servlet-api</artifactId>
      <version>6.0.0</version>
      <scope>provided</scope>
    </dependency>
  
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.8.1</version>
        <configuration>
          <source>17</source>
          <target>17</target>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>3.3.1</version>
      </plugin>
    </plugins>
  </build>


--------------------------// login.html -----------------------------------------
<!DOCTYPE html>
<html>
<head>
<title>Login</title>
</head>
<body>
    <h2>Login</h2>
    <form action="LoginServlet" method="post">
        Username: <input type="text" name="username"><br>
        Password: <input type="password" name="password"><br>
        <input type="submit" value="Login">
    </form>
</body>
</html>

--------------------------// LoginServlet.java--------------------------------

@WebServlet("/LoginServlet")
public class LoginServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;
    private Connection connection;

    @Override
    public void init() throws ServletException {
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            String url = "jdbc:mysql://localhost/your_database"; // Replace with your database URL
            String user = "your_username"; // Replace with your database username
            String password = "your_password"; // Replace with your database password
            connection = DriverManager.getConnection(url, user, password);
        } catch (ClassNotFoundException | SQLException e) {
            e.printStackTrace();
            throw new ServletException("Database connection failed", e);
        }
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter out = response.getWriter();

        String username = request.getParameter("username");
        String password = request.getParameter("password");

        try {
            String sql = "SELECT * FROM users WHERE username = ? AND password = ?";
            PreparedStatement statement = connection.prepareStatement(sql);
            statement.setString(1, username);
            statement.setString(2, password);
            ResultSet resultSet = statement.executeQuery();

            if (resultSet.next()) {
                HttpSession session = request.getSession();
                session.setAttribute("username", username); // Set session attribute
                response.sendRedirect("welcome.jsp"); // Redirect to welcome page
            } else {
                out.println("<p style='color:red;'>Invalid username or password.</p>");
                request.getRequestDispatcher("login.html").include(request, response); // include login page
            }
        } catch (SQLException e) {
            e.printStackTrace();
            out.println("<p style='color:red;'>Database error: " + e.getMessage() + "</p>");
            request.getRequestDispatcher("login.html").include(request, response);
        }
    }

    @Override
    public void destroy() {
        try {
            if (connection != null && !connection.isClosed()) {
                connection.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}

-----------------------------// welcome.jsp ----------------------------
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%
    if (session == null || session.getAttribute("username") == null) {
        response.sendRedirect("login.html");
        return;
    }
    String username = (String) session.getAttribute("username");
%>
<!DOCTYPE html>
<html>
<head>
<title>Welcome</title>
</head>
<body>
    <h1>Welcome, <%= username %>!</h1>
    <a href="LogoutServlet">Logout</a>
</body>
</html>

----------------------- // LogoutServlet.java -------------------------------

@WebServlet("/LogoutServlet")
public class LogoutServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        HttpSession session = request.getSession(false);
        if (session != null) {
            session.invalidate(); // Invalidate the session
        }
        response.sendRedirect("login.html"); // Redirect to login page
    }
}











-
